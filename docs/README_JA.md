![preview](./assets/preview.png)

<h1 align="center">Telegram Search</h1>

<p align="center">
  <a href="https://trendshift.io/repositories/13868" target="_blank"><img src="https://trendshift.io/api/badge/repositories/13868" alt="groupultra%2Ftelegram-search | Trendshift" style="width: 250px; height: 55px;" width="250" height="55"/></a>
</p>

<p align="center">
  [<a href="https://search.lingogram.app">ã™ãã«ä½¿ç”¨</a>] [<a href="https://discord.gg/NzYsmJSgCT">Discord ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ </a>] [<a href="../README.md">English</a>] [<a href="./README_CN.md">ç®€ä½“ä¸­æ–‡</a>]
</p>

<p align="center">
  <a href="https://app.netlify.com/projects/tgsearch/deploys"><img src="https://api.netlify.com/api/v1/badges/89bfbfd2-0f73-41b0-8db4-4ab6b6512f6e/deploy-status"></a>
  <a href="https://deepwiki.com/GramSearch/telegram-search"><img src="https://deepwiki.com/badge.svg"></a>
  <a href="https://github.com/GramSearch/telegram-search/blob/main/LICENSE"><img src="https://img.shields.io/github/license/GramSearch/telegram-search.svg?style=flat&colorA=080f12&colorB=1fa669"></a>
    <a href="https://discord.gg/NzYsmJSgCT"><img src="https://img.shields.io/badge/dynamic/json?url=https%3A%2F%2Fdiscord.com%2Fapi%2Finvites%2FNzYsmJSgCT%3Fwith_counts%3Dtrue&query=%24.approximate_member_count&suffix=%20members&logo=discord&logoColor=white&label=%20&color=7389D8&labelColor=6A7EC2"></a>
  <a href="https://t.me/+Gs3SH2qAPeFhYmU9"><img src="https://img.shields.io/badge/Telegram-%235AA9E6?logo=telegram&labelColor=FFFFFF"></a>
</p>

> [!WARNING]
> ä»®æƒ³é€šè²¨ã¯ä¸€åˆ‡ç™ºè¡Œã—ã¦ã„ã¾ã›ã‚“ã€‚è©æ¬ºã«ã”æ³¨æ„ãã ã•ã„ã€‚

> [!CAUTION]
> ã“ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯è‡ªåˆ†ã®ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦æ¤œç´¢ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚é•æ³•ãªç›®çš„ã§ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚

ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã¨ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒƒãƒãƒ³ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹å¼·åŠ›ãª Telegram ãƒãƒ£ãƒƒãƒˆå±¥æ­´æ¤œç´¢ãƒ„ãƒ¼ãƒ«ã€‚OpenAI ã®ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒ™ã‚¯ãƒˆãƒ«æŠ€è¡“ã«åŸºã¥ã„ã¦ã€Telegram ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ¤œç´¢ã‚’ã‚ˆã‚Šã‚¹ãƒãƒ¼ãƒˆã§æ­£ç¢ºã«ã—ã¾ã™ã€‚

## ğŸ’– ã‚¹ãƒãƒ³ã‚µãƒ¼

![Sponsors](https://github.com/luoling8192/luoling8192/raw/master/sponsorkit/sponsors.svg)

## ğŸŒ ã™ãã«ä½¿ç”¨

æˆ‘ã€…ã¯ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æä¾›ã—ã¦ãŠã‚Šã€Telegram Search ã®ã™ã¹ã¦ã®æ©Ÿèƒ½ã‚’ä½“é¨“ã§ãã¾ã™ã€‚

> [!NOTE]
> æˆ‘ã€…ã¯ã‚ãªãŸã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’å°Šé‡ã—ã¾ã™ã€‚

ä»¥ä¸‹ã® URL ã‹ã‚‰é–‹å§‹ã—ã¦ãã ã•ã„ï¼šhttps://search.lingogram.app

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ç’°å¢ƒå¤‰æ•°

> [!TIP]
> ã™ã¹ã¦ã®ç’°å¢ƒå¤‰æ•°ã¯ä»»æ„ã§ã™ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§å‹•ä½œã—ã¾ã™ãŒã€ã“ã‚Œã‚‰ã®å¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§å‹•ä½œã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

### Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰èµ·å‹•

> [!IMPORTANT]
> æœ€ã‚‚ç°¡å˜ãªå§‹ã‚æ–¹ã¯ã€è¨­å®šãªã—ã§ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã™ã€‚ã™ã¹ã¦ã®æ©Ÿèƒ½ãŒåˆç†çš„ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§å‹•ä½œã—ã¾ã™ã€‚

1. ç’°å¢ƒå¤‰æ•°ãªã—ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
docker run -d --name telegram-search \
  -p 3333:3333 \
  -v telegram-search-data:/app/data \
  ghcr.io/groupultra/telegram-search:latest
```

<details>
<summary>ç’°å¢ƒå¤‰æ•°ã‚ã‚Šã®ä¾‹</summary>

ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã™ã‚‹å‰ã«ã€ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚

| å¤‰æ•° | å¿…é ˆ | èª¬æ˜ |
| --- | --- | --- |
| `TELEGRAM_API_ID` | ä»»æ„ | [my.telegram.org](https://my.telegram.org/apps) ã§å–å¾—ã—ãŸ Telegram ã‚¢ãƒ—ãƒª IDã€‚ |
| `TELEGRAM_API_HASH` | ä»»æ„ | åŒã˜ãƒšãƒ¼ã‚¸ã§å–å¾—ã§ãã‚‹ Telegram ã‚¢ãƒ—ãƒª Hashã€‚ |
| `DATABASE_TYPE` | ä»»æ„ | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—ï¼ˆ`postgres` ã¾ãŸã¯ `pglite`ï¼‰ã€‚ |
| `DATABASE_URL` | ä»»æ„ | ã‚µãƒ¼ãƒãƒ¼ã¨ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒåˆ©ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæ–‡å­—åˆ—ï¼ˆ`DATABASE_TYPE` ãŒ `postgres` ã®å ´åˆã®ã¿ã‚µãƒãƒ¼ãƒˆï¼‰ã€‚ |
| `EMBEDDING_API_KEY` | ä»»æ„ | åŸ‹ã‚è¾¼ã¿ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã® API ã‚­ãƒ¼ï¼ˆOpenAIã€Ollama ãªã©ï¼‰ã€‚ |
| `EMBEDDING_BASE_URL` | ä»»æ„ | è‡ªå‰ãƒ›ã‚¹ãƒˆã‚„äº’æ›ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼å‘ã‘ã® API ãƒ™ãƒ¼ã‚¹ URLã€‚ |
| `EMBEDDING_PROVIDER` | ä»»æ„ | åŸ‹ã‚è¾¼ã¿ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’ä¸Šæ›¸ãï¼ˆ`openai` ã¾ãŸã¯ `ollama`ï¼‰ã€‚ |
| `EMBEDDING_MODEL` | ä»»æ„ | ä½¿ç”¨ã™ã‚‹åŸ‹ã‚è¾¼ã¿ãƒ¢ãƒ‡ãƒ«åã‚’ä¸Šæ›¸ãã€‚ |
| `EMBEDDING_DIMENSION` | ä»»æ„ | åŸ‹ã‚è¾¼ã¿ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒæ•°ã‚’ä¸Šæ›¸ãï¼ˆ`1536`ã€`1024`ã€`768` ãªã©ï¼‰ã€‚ |
| `PROXY_URL` | ä»»æ„ | ãƒ—ãƒ­ã‚­ã‚·è¨­å®šURLï¼ˆä¾‹ï¼š`socks5://user:pass@host:port`ï¼‰ã€‚ |

### ãƒ—ãƒ­ã‚­ã‚·URLå½¢å¼

`PROXY_URL` ç’°å¢ƒå¤‰æ•°ã¯ä»¥ä¸‹ã®å½¢å¼ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ï¼š

- **SOCKS4**: `socks4://username:password@host:port?timeout=15`
- **SOCKS5**: `socks5://username:password@host:port?timeout=15`
- **HTTP**: `http://username:password@host:port?timeout=15`
- **MTProxy**: `mtproxy://secret@host:port?timeout=15`

ä¾‹ï¼š
- `PROXY_URL=socks5://myuser:mypass@proxy.example.com:1080`
- `PROXY_URL=mtproxy://secret123@mtproxy.example.com:443`
- `PROXY_URL=socks5://proxy.example.com:1080?timeout=30` ï¼ˆèªè¨¼ãªã—ï¼‰

```bash
docker run -d --name telegram-search \
  -p 3333:3333 \
  -v telegram-search-data:/app/data \
  -e TELEGRAM_API_ID=611335 \
  -e TELEGRAM_API_HASH=d524b414d21f4d37f08684c1df41ac9c \
  -e DATABASE_TYPE=postgres \
  -e DATABASE_URL=postgresql://<postgres-host>:5432/postgres \
  -e EMBEDDING_API_KEY=sk-xxxx \
  -e EMBEDDING_BASE_URL=https://api.openai.com/v1 \
  ghcr.io/groupultra/telegram-search:latest
```

`<postgres-host>` ã«ã¯åˆ©ç”¨ã—ãŸã„ PostgreSQL ã®ãƒ›ã‚¹ãƒˆåã¾ãŸã¯ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚

</details>

2. http://localhost:3333 ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ¤œç´¢ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’é–‹ãã¾ã™ã€‚

### Docker Compose ã§èµ·å‹•

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¾ã™ã€‚

2. docker compose ã‚’å®Ÿè¡Œã—ã¦ã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•ã—ã¾ã™ã€‚

```bash
docker compose up -d
```

3. http://localhost:3333 ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ¤œç´¢ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’é–‹ãã¾ã™ã€‚

## ğŸ’» é–‹ç™ºã‚¬ã‚¤ãƒ‰

> [!CAUTION]
> é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã«ã¯ Node.js >= 22.18 ã¨ pnpm ãŒå¿…è¦ã§ã™ã€‚ç¶šè¡Œã™ã‚‹å‰ã«æ­£ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

### ã‚¦ã‚§ãƒ–ãƒ¢ãƒ¼ãƒ‰

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³

2. ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pnpm install
```

3. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼š

```bash
pnpm run dev
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ¢ãƒ¼ãƒ‰

1. ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³

2. ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
pnpm install
```

3. ç’°å¢ƒã‚’è¨­å®š

```bash
cp config/config.example.yaml config/config.yaml
```

4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ï¼š

```bash
# ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ã¯ã€Docker ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚³ãƒ³ãƒ†ãƒŠã®ã¿ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
docker compose up -d pgvector
```

5. ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•ï¼š

```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•
pnpm run server:dev

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’èµ·å‹•
pnpm run web:dev
```

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```mermaid
graph TB
    subgraph "ğŸ–¥ï¸ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ¬ã‚¤ãƒ¤ãƒ¼"
        Frontend["Web ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰<br/>(Vue 3 + Pinia)"]
        Electron["Electron ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—"]
        
        subgraph "ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼"
            ClientAuth["èªè¨¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            ClientMessage["ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"] 
            ClientStorage["ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            ClientEntity["ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            ClientServer["ã‚µãƒ¼ãƒãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
        end
    end

    subgraph "ğŸŒ é€šä¿¡ãƒ¬ã‚¤ãƒ¤ãƒ¼"
        WS["WebSocket ã‚¤ãƒ™ãƒ³ãƒˆãƒ–ãƒªãƒƒã‚¸<br/>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæ–¹å‘é€šä¿¡<br/>â€¢ ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²<br/>â€¢ ã‚¤ãƒ™ãƒ³ãƒˆè»¢é€<br/>â€¢ ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†"]
    end

    subgraph "ğŸš€ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼"
        Server["ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼<br/>(REST API)"]
        
        subgraph "ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†"
            SessionMgr["ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼<br/>â€¢ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹<br/>â€¢ CoreContext ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹<br/>â€¢ ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼"]
        end
    end

    subgraph "ğŸ¯ ã‚³ã‚¢ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ "
        Context["CoreContext<br/>ğŸ”¥ ä¸­å¤®ã‚¤ãƒ™ãƒ³ãƒˆãƒã‚¹<br/>(EventEmitter3)<br/>â€¢ ToCoreEvent<br/>â€¢ FromCoreEvent<br/>â€¢ ã‚¤ãƒ™ãƒ³ãƒˆãƒ©ãƒƒãƒ‘ãƒ¼<br/>â€¢ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°"]
        
        subgraph "ã‚³ã‚¢ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼"
            AuthHandler["ğŸ” èªè¨¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            MessageHandler["ğŸ“ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            DialogHandler["ğŸ’¬ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            StorageHandler["ğŸ“¦ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            ConfigHandler["âš™ï¸ è¨­å®šãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            EntityHandler["ğŸ‘¤ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            GramEventsHandler["ğŸ“¡ Gram ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
            MessageResolverHandler["ğŸ”„ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¾ãƒ«ãƒãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼"]
        end
    end

    subgraph "ğŸ”§ ãƒ“ã‚¸ãƒã‚¹ã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ã‚¤ãƒ¤ãƒ¼"
        subgraph "ã‚µãƒ¼ãƒ“ã‚¹"
            AuthService["èªè¨¼<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
            MessageService["ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
            DialogService["ãƒ€ã‚¤ã‚¢ãƒ­ã‚°<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
            StorageService["ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
            ConfigService["è¨­å®š<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
            EntityService["ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
            ConnectionService["æ¥ç¶š<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
            TakeoutService["ãƒ†ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆ<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
        end
        
        subgraph "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³"
            MsgResolverService["ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¾ãƒ«ãƒãƒ¼<br/>ã‚µãƒ¼ãƒ“ã‚¹"]
            
            subgraph "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¾ãƒ«ãƒãƒ¼"
                EmbeddingResolver["ğŸ¤– åŸ‹ã‚è¾¼ã¿<br/>ãƒªã‚¾ãƒ«ãƒãƒ¼<br/>(OpenAI)"]
                JiebaResolver["ğŸ“š Jieba<br/>ãƒªã‚¾ãƒ«ãƒãƒ¼<br/>ï¼ˆä¸­å›½èªåˆ†å‰²ï¼‰"]
                LinkResolver["ğŸ”— ãƒªãƒ³ã‚¯<br/>ãƒªã‚¾ãƒ«ãƒãƒ¼"]
                MediaResolver["ğŸ“¸ ãƒ¡ãƒ‡ã‚£ã‚¢<br/>ãƒªã‚¾ãƒ«ãƒãƒ¼"]
                UserResolver["ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼<br/>ãƒªã‚¾ãƒ«ãƒãƒ¼"]
            end
        end
    end

    subgraph "ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ãƒ¤ãƒ¼"
        DB["PostgreSQL<br/>+ pgvector"]
        Drizzle["Drizzle ORM"]
    end

    subgraph "ğŸ“¡ å¤–éƒ¨ API"
        TelegramAPI["Telegram API<br/>(gram.js)"]
        OpenAI["OpenAI API<br/>ãƒ™ã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿"]
    end

    %% WebSocket ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼
    Frontend -.->|"WsEventToServer<br/>â€¢ auth:login<br/>â€¢ message:query<br/>â€¢ dialog:fetch"| WS
    WS -.->|"WsEventToClient<br/>â€¢ message:data<br/>â€¢ auth:status<br/>â€¢ storage:progress"| Frontend
    
    Electron -.->|"WebSocket ã‚¤ãƒ™ãƒ³ãƒˆ"| WS
    WS -.->|"ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°"| Electron

    %% ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ¤ãƒ¼
    WS <--> Server
    Server --> SessionMgr
    SessionMgr --> Context

    %% ã‚³ã‚¢ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¦ç‚¹ï¼‰
    Context <==> AuthHandler
    Context <==> MessageHandler
    Context <==> DialogHandler
    Context <==> StorageHandler
    Context <==> ConfigHandler
    Context <==> EntityHandler
    Context <==> GramEventsHandler
    Context <==> MessageResolverHandler

    %% ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‹ã‚‰ã‚µãƒ¼ãƒ“ã‚¹ã¸
    AuthHandler --> AuthService
    MessageHandler --> MessageService
    DialogHandler --> DialogService
    StorageHandler --> StorageService
    ConfigHandler --> ConfigService
    EntityHandler --> EntityService
    GramEventsHandler --> ConnectionService
    MessageResolverHandler --> MsgResolverService

    %% ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
    MessageService --> MsgResolverService
    MsgResolverService --> EmbeddingResolver
    MsgResolverService --> JiebaResolver
    MsgResolverService --> LinkResolver
    MsgResolverService --> MediaResolver
    MsgResolverService --> UserResolver

    %% ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ãƒ¤ãƒ¼
    StorageService --> Drizzle
    Drizzle --> DB

    %% å¤–éƒ¨ API
    AuthService --> TelegramAPI
    MessageService --> TelegramAPI
    DialogService --> TelegramAPI
    EntityService --> TelegramAPI
    EmbeddingResolver --> OpenAI

    %% ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
    Frontend --> ClientAuth
    Frontend --> ClientMessage
    Frontend --> ClientStorage
    Frontend --> ClientEntity
    Frontend --> ClientServer

    %% ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
    classDef frontend fill:#4CAF50,stroke:#2E7D32,color:#fff,stroke-width:2px
    classDef websocket fill:#FF9800,stroke:#E65100,color:#fff,stroke-width:3px
    classDef server fill:#2196F3,stroke:#1565C0,color:#fff,stroke-width:2px
    classDef context fill:#E91E63,stroke:#AD1457,color:#fff,stroke-width:4px
    classDef handler fill:#9C27B0,stroke:#6A1B9A,color:#fff,stroke-width:2px
    classDef service fill:#607D8B,stroke:#37474F,color:#fff,stroke-width:2px
    classDef resolver fill:#795548,stroke:#3E2723,color:#fff,stroke-width:2px
    classDef data fill:#3F51B5,stroke:#1A237E,color:#fff,stroke-width:2px
    classDef external fill:#F44336,stroke:#C62828,color:#fff,stroke-width:2px

    class Frontend,Electron,ClientAuth,ClientMessage,ClientStorage,ClientEntity,ClientServer frontend
    class WS websocket
    class Server,SessionMgr server
    class Context context
    class AuthHandler,MessageHandler,DialogHandler,StorageHandler,ConfigHandler,EntityHandler,GramEventsHandler,MessageResolverHandler handler
    class AuthService,MessageService,DialogService,StorageService,ConfigService,EntityService,ConnectionService,TakeoutService,MsgResolverService service
    class EmbeddingResolver,JiebaResolver,LinkResolver,MediaResolver,UserResolver resolver
    class DB,Drizzle data
    class TelegramAPI,OpenAI external
```

### ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ¦‚è¦

- **ğŸ¯ CoreContext - ä¸­å¤®ã‚¤ãƒ™ãƒ³ãƒˆãƒã‚¹**: EventEmitter3 ã‚’ä½¿ç”¨ã—ã¦ã™ã¹ã¦ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç®¡ç†ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã®ä¸­å¿ƒ
  - **ToCoreEvent**: ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ ã«é€ä¿¡ã•ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆauth:loginã€message:query ãªã©ï¼‰
  - **FromCoreEvent**: ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ç™ºè¡Œã•ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆmessage:dataã€auth:status ãªã©ï¼‰
  - **ã‚¤ãƒ™ãƒ³ãƒˆãƒ©ãƒƒãƒ”ãƒ³ã‚°**: ã™ã¹ã¦ã®ã‚¤ãƒ™ãƒ³ãƒˆã®è‡ªå‹•ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨ãƒ­ã‚®ãƒ³ã‚°
  - **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: å„ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ç‹¬è‡ªã® CoreContext ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹

- **ğŸŒ WebSocket ã‚¤ãƒ™ãƒ³ãƒˆãƒ–ãƒªãƒƒã‚¸**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæ–¹å‘é€šä¿¡ãƒ¬ã‚¤ãƒ¤ãƒ¼
  - **ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²**: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå—ä¿¡ã—ãŸã„ç‰¹å®šã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™»éŒ²
  - **ã‚¤ãƒ™ãƒ³ãƒˆè»¢é€**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ CoreContext é–“ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«è»¢é€
  - **ã‚»ãƒƒã‚·ãƒ§ãƒ³æ°¸ç¶šæ€§**: æ¥ç¶šå…¨ä½“ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ç¶­æŒ

- **ğŸ”„ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**: è¤‡æ•°ã®ãƒªã‚¾ãƒ«ãƒãƒ¼ã‚’é€šã˜ãŸã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†
  - **åŸ‹ã‚è¾¼ã¿ãƒªã‚¾ãƒ«ãƒãƒ¼**: ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ã®ãŸã‚ã« OpenAI ã‚’ä½¿ç”¨ã—ã¦ãƒ™ã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿ã‚’ç”Ÿæˆ
  - **Jieba ãƒªã‚¾ãƒ«ãƒãƒ¼**: ã‚ˆã‚Šè‰¯ã„æ¤œç´¢æ©Ÿèƒ½ã®ãŸã‚ã®ä¸­å›½èªå˜èªåˆ†å‰²
  - **ãƒªãƒ³ã‚¯/ãƒ¡ãƒ‡ã‚£ã‚¢/ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¾ãƒ«ãƒãƒ¼**: ã•ã¾ã–ã¾ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—ã‚’æŠ½å‡ºã—ã¦å‡¦ç†

- **ğŸ“¡ ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼**:
  1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒ WebSocket çµŒç”±ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œï¼ˆä¾‹ï¼š`auth:login`ã€`message:query`ï¼‰
  2. ã‚µãƒ¼ãƒãƒ¼ãŒé©åˆ‡ãª CoreContext ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’è»¢é€
  3. ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãŒã‚¤ãƒ™ãƒ³ãƒˆã‚’å‡¦ç†ã—ã€å¯¾å¿œã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’å‘¼ã³å‡ºã™
  4. ã‚µãƒ¼ãƒ“ã‚¹ãŒ CoreContext çµŒç”±ã§çµæœã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œ
  5. WebSocket ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã®ãŸã‚ã«ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’è»¢é€

## ğŸš€ ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£

![Alt](https://repobeats.axiom.co/api/embed/69d5ef9f5e72cd7901b32ff71b5f359bc7ca42ea.svg "Repobeats analytics image")

[![Star History Chart](https://api.star-history.com/svg?repos=luoling8192/telegram-search&type=Date)](https://star-history.com/#luoling8192/telegram-search&Date)
